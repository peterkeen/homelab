<%-
endpoints = []

all_web_configs do |host, stack, service, web_conf|
  endpoint = service.config.fetch(:"x-gatus", {}).dup

  next unless endpoint.length > 0 || web_conf

  next if endpoint[:enabled] == false

  endpoint[:name] ||= web_conf[:name] || service.name
  endpoint[:url] ||= "https://" + web_conf[:fqdn]
  endpoint[:interval] ||= "5m"
  endpoint[:conditions] ||= ["[STATUS] == 200"]
  endpoint[:alerts] ||= [
    {
      "type" => "email", 
    }
  ]
  endpoints << endpoint
end

-%>
<%= dump_yaml_without_symbols({"endpoints" => endpoints}) %>
